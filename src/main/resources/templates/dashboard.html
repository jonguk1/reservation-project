<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>관리자 대시보드</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        .status-badge { font-size: 1.1rem; padding: 5px 10px; }
        .wait-text { color: #dc3545; font-weight: bold; }
        .active-text { color: #28a745; font-weight: bold; }
    </style>
</head>
<body class="container mt-5">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>선착순 시스템 관리자 대시보드</h2>
        <a href="/goods" class="btn btn-outline-primary">사용자 화면으로</a>
    </div>

    <table class="table table-hover shadow-sm">
        <thead class="thead-dark">
            <tr>
                <th>ID</th>
                <th>상품명</th>
                <th>현재 재고</th>
                <th>대기열(Wait)</th>
                <th>진입자(Active)</th>
                <th>재고 수정</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="item : ${goodsList}">
                <td th:text="${item.goods.id}"></td>
                <td th:text="${item.goods.name}" class="font-weight-bold"></td>
                <td>
                    <span class="badge badge-info status-badge" th:text="${item.goods.stockQuantity} + '개'"></span>
                </td>
                <td>
                    <span class="wait-text" th:text="${item.waitCount} + '명'"></span>
                </td>
                <td>
                    <span class="active-text" th:text="${item.activeCount} + '명'"></span>
                </td>
                <td>
                    <form th:action="@{/admin/update-stock}" method="post" class="form-inline">
                        <input type="hidden" name="goodsId" th:value="${item.goods.id}">
                        <input type="number" name="stock" class="form-control form-control-sm mr-2" style="width: 80px;" th:value="${item.goods.stockQuantity}">
                        <button type="submit" class="btn btn-sm btn-dark">수정</button>
                    </form>
                </td>
            </tr>
        </tbody>
    </table>

    <div class="alert alert-light border mt-4">
        <h5>관리자 가이드</h5>
        <ul>
            <li><strong>대기열(Wait):</strong> 현재 <code>waiting.html</code>에서 순서를 기다리는 유저 수입니다.</li>
            <li><strong>진입자(Active):</strong> 현재 결제 폼에 진입하여 재고를 선점 중인 유저 수입니다.</li>
            <li>재고를 0으로 설정하면 즉시 사용자 화면에 <strong>Sold Out</strong>이 표시됩니다.</li>
        </ul>
    </div>

</body>
</html>